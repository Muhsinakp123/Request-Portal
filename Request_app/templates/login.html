{% extends "master.html" %}
{% block title %}Login{% endblock %}
{% block content %}
<div class="card">

    <h3>Login</h3>

    {% if messages %}
    <div id="messageBox" class="alert alert-danger">
        {% for message in messages %}
            {{ message }}<br>
        {% endfor %}
    </div>
    {% endif %}

    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button class="btn-primary mt-2">Login</button>
    </form>

    <p class="text-center mt-3 small">
        <a href="#" onclick="submitForgot();">Forgot Password?</a>
    </p>

    <form method="post" action="{% url 'forgot_password' %}" id="forgotForm">
        <p class="text-center mt-3 small"> Don't have an account? <a href="{% url 'signup' %}">Sign up</a> </p>
        {% csrf_token %}
        <input type="hidden" name="username" id="forgotUsername">
    </form>

</div>

<script>
function submitForgot() {
    const usernameField = document.querySelector("input[name='username']");
    const hiddenField = document.getElementById("forgotUsername");

    if (usernameField.value.trim() === "") {
        alert("Please enter your username before continuing.");
        return;
    }
    hiddenField.value = usernameField.value;
    document.getElementById("forgotForm").submit();
}
</script>

{% endblock %}
